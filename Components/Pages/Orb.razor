@rendermode InteractiveServer
@inject ILogger<Orb> Log


@if(AllowDialog) {
    <Modal Title="@("Edit " + OrbGauge.Name)" id="@OrbGauge.Name">
        <div class=p-3>
          <div class="d-flex flex-row flex-wrap gap-3">
            <Orb OrbGauge="@OrbGauge" AllowDialog="false" />
            <div class="m-auto flex-grow-1">

              <h2 class="w-100 text-center">Set</h2>
              <input type="number" class="w-100 form-control" @bind="@OrbGauge.Value">
              <input type="range" class="w-100" @bind="@OrbGauge.Value" max="@OrbGauge.Max" style=" "/>


              <h2 class="w-100 text-center">Modify</h2>

              <input type="number" class="w-100 form-control" @bind="@IncrementValue"/>

              <div class="d-flex w-100 flex-row flex-nowrap gap-1">


                <button class="btn btn-primary w-100" @onclick="Decrement">
                  <span>-@Math.Abs(IncrementValue)</span>
                </button>

                <button class="btn btn-primary w-100" @onclick="Increment">
                  <span>+@Math.Abs(IncrementValue)</span>
                </button>
              </div>
            </div>
          </div>
        </div>
    </Modal>

}

<div onclick="@(OrbGauge.Name).showModal()" class="orb m-auto" style="max-width: 40%">

  <div class="orb-label d-flex flex-wrap">
  <div class="d-flex flex-row w-100">
    @OrbGauge.Name
  </div >

  <div class="d-flex flex-row m-100 m-auto">
     <!-- <input style="width: 50px;" value="@OrbGauge.Value"/> -->
      <span class="m-auto">@OrbGauge.Value</span>
    
      <span class="m-auto">/</span>

      <span class="m-auto">@OrbGauge.Max</span>
  </div>
  </div>


  <div class="orb-liquid" style="height:@Percentage%; --orb-colour:@OrbGauge.Colour">
  </div>
</div>



@code {

  [Parameter]
  public bool AllowDialog {get; set;} = true;


  private int IncrementValue {get; set;}

  void Increment() {
      OrbGauge.Value += IncrementValue;
  }
  void Decrement() {
      OrbGauge.Value -= IncrementValue;
  }

  [Parameter]
  public Gauge OrbGauge { get; set; }


  [Parameter]
  public EventCallback<Gauge>? ChangedCallback { get; set; }

  private float Percentage => ((float)OrbGauge.Value / (float)OrbGauge.Max)*100;

}
